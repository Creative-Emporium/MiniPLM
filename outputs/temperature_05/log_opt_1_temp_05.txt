[2023-09-02 13:12:34,936] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.16s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:03,  3.98s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:10<00:00,  3.21s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:10<00:00,  3.43s/it]
Target Model - facebook/opt-13b
Draft Model - facebook/opt-1.3b
************

HF's generate
Count of new tokens: 78
</s>When the rain started falling upwards, Lily knew something was terribly wrong.
She was in the middle of a forest, and the rain was coming from the sky.
She looked around, and saw that the trees were all swaying, and the leaves were falling from the trees.
She looked up, and saw that the sky was dark, and the clouds were moving in a way
******
Naive Autoregressive with temperature
Count of new tokens: 64
</s>When the rain started falling upwards, Lily knew something was terribly wrong.
She was soaking wet, and the rain was falling harder than it had ever fallen before.
The wind was blowing like a hurricane, and the clouds were so dark and ominous that she was sure the sky was about to open up and swallow them
******
Speculative Sampling with temperature
Count of new tokens: 64
</s>When the rain started falling upwards, Lily knew something was terribly wrong.
She had been in the middle of her morning jog when she saw a flash of lightning and heard the thunder.
She had seen rain before, but she had never seen it fall like that.
She had never seen it fall at all,
******
Benchmarking naive Autoregressive Sampling...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:05<01:04,  5.86s/it] 17%|█▋        | 2/12 [00:11<00:54,  5.49s/it] 25%|██▌       | 3/12 [00:16<00:48,  5.40s/it] 33%|███▎      | 4/12 [00:21<00:41,  5.22s/it] 42%|████▏     | 5/12 [00:25<00:34,  4.96s/it] 50%|█████     | 6/12 [00:30<00:29,  4.93s/it] 58%|█████▊    | 7/12 [00:35<00:24,  4.88s/it] 67%|██████▋   | 8/12 [00:40<00:19,  4.86s/it] 75%|███████▌  | 9/12 [00:45<00:14,  4.81s/it] 83%|████████▎ | 10/12 [00:49<00:09,  4.83s/it] 92%|█████████▏| 11/12 [00:54<00:04,  4.75s/it]100%|██████████| 12/12 [00:59<00:00,  4.94s/it]100%|██████████| 12/12 [00:59<00:00,  4.99s/it]
Time per token (Autoregressive Sampling): 12.44 tok/s
Benchmarking Speculative Sampling...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:03<00:36,  3.28s/it] 17%|█▋        | 2/12 [00:06<00:34,  3.43s/it] 25%|██▌       | 3/12 [00:11<00:34,  3.86s/it] 33%|███▎      | 4/12 [00:14<00:29,  3.70s/it] 42%|████▏     | 5/12 [00:16<00:21,  3.13s/it] 50%|█████     | 6/12 [00:20<00:19,  3.25s/it] 58%|█████▊    | 7/12 [00:22<00:14,  2.97s/it] 67%|██████▋   | 8/12 [00:25<00:11,  2.81s/it] 75%|███████▌  | 9/12 [00:28<00:08,  2.93s/it] 83%|████████▎ | 10/12 [00:31<00:06,  3.05s/it] 92%|█████████▏| 11/12 [00:34<00:03,  3.04s/it]100%|██████████| 12/12 [00:37<00:00,  3.06s/it]100%|██████████| 12/12 [00:37<00:00,  3.14s/it]
Time per token (Speculative Sampling): 20.53 tok/s
