[2023-09-02 13:16:18,192] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:08,  4.19s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:08<00:04,  4.17s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:10<00:00,  3.25s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:10<00:00,  3.50s/it]
Target Model - facebook/opt-13b
Draft Model - facebook/opt-1.3b
************

HF's generate
Count of new tokens: 70
</s>What did Rutherford discover?

Rutherford discovered the atomic nucleus, the atom, and the electron. He also discovered the alpha particle, the beta particle, and the gamma ray. He also discovered the proton and the neutron. He also discovered the electron's spin. He also discovered the electron's charge. He also discovered the electron's spin
******
Naive Autoregressive with temperature
Count of new tokens: 64
</s>What did Rutherford discover?

Rutherford discovered the atomic nucleus, which was a complete surprise to everyone. He was working on a different problem when he made the discovery.

Rutherford also discovered that the atom was made of smaller particles called protons and neutrons. He discovered that the nucleus was made of
******
Speculative Sampling with temperature
Count of new tokens: 67
</s>What did Rutherford discover?

Rutherford discovered the elements, and he discovered the structure of the atom.

Rutherford discovered the elements, and he discovered the structure of the atom.

Rutherford discovered the elements, and he discovered the structure of the atom.

Rutherford discovered the elements, and he discovered
******
Benchmarking naive Autoregressive Sampling...
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:05<00:58,  5.86s/it] 18%|█▊        | 2/11 [00:11<00:50,  5.61s/it] 27%|██▋       | 3/11 [00:16<00:43,  5.40s/it] 36%|███▋      | 4/11 [00:21<00:36,  5.25s/it] 45%|████▌     | 5/11 [00:26<00:31,  5.22s/it] 55%|█████▍    | 6/11 [00:31<00:25,  5.17s/it] 64%|██████▎   | 7/11 [00:36<00:20,  5.12s/it] 73%|███████▎  | 8/11 [00:41<00:15,  5.13s/it] 82%|████████▏ | 9/11 [00:47<00:10,  5.16s/it] 91%|█████████ | 10/11 [00:52<00:05,  5.20s/it]100%|██████████| 11/11 [00:57<00:00,  5.12s/it]100%|██████████| 11/11 [00:57<00:00,  5.21s/it]
Time per token (Autoregressive Sampling): 11.90 tok/s
Benchmarking Speculative Sampling...
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:03<00:31,  3.14s/it] 18%|█▊        | 2/11 [00:06<00:29,  3.29s/it] 27%|██▋       | 3/11 [00:09<00:26,  3.36s/it] 36%|███▋      | 4/11 [00:13<00:23,  3.30s/it] 45%|████▌     | 5/11 [00:15<00:18,  3.01s/it] 55%|█████▍    | 6/11 [00:19<00:15,  3.13s/it] 64%|██████▎   | 7/11 [00:22<00:13,  3.33s/it] 73%|███████▎  | 8/11 [00:25<00:09,  3.26s/it] 82%|████████▏ | 9/11 [00:28<00:06,  3.08s/it] 91%|█████████ | 10/11 [00:31<00:03,  3.13s/it]100%|██████████| 11/11 [00:34<00:00,  3.09s/it]100%|██████████| 11/11 [00:34<00:00,  3.16s/it]
Time per token (Speculative Sampling): 20.14 tok/s
