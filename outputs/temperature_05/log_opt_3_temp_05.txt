[2023-09-02 13:23:42,276] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.35s/it]
Target Model - facebook/opt-6.7b
Draft Model - facebook/opt-1.3b
************

HF's generate
Count of new tokens: 86
</s>When the town's clock tower chimed 13 times, the residents realized they were trapped in a time loop.

The residents of a small town in the United Kingdom were trapped in a time loop after the town's clock tower chimed 13 times.

The residents of the small town of Great Missenden, Buckinghamshire, were trapped in a time loop after the town's clock tower chimed 13 times.

******
Naive Autoregressive with temperature
Count of new tokens: 64
</s>When the town's clock tower chimed 13 times, the residents realized they were trapped in a time loop.

In the film, a young boy named Alex (played by Alex Wolff) finds himself in a time loop. The town's clock tower chimes 13 times, and Alex finds himself trapped in the
******
Speculative Sampling with temperature
Count of new tokens: 67
</s>When the town's clock tower chimed 13 times, the residents realized they were trapped in a time loop.

They'd been there for two years.

The residents of the town of Riverton were trapped in a time loop.

The town's clock tower chimed 13 times.

The residents of the
******
Benchmarking naive Autoregressive Sampling...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:03<00:39,  3.61s/it] 17%|█▋        | 2/12 [00:06<00:33,  3.37s/it] 25%|██▌       | 3/12 [00:10<00:29,  3.31s/it] 33%|███▎      | 4/12 [00:13<00:25,  3.19s/it] 42%|████▏     | 5/12 [00:15<00:21,  3.03s/it] 50%|█████     | 6/12 [00:18<00:18,  3.01s/it] 58%|█████▊    | 7/12 [00:21<00:14,  2.98s/it] 67%|██████▋   | 8/12 [00:24<00:11,  2.96s/it] 75%|███████▌  | 9/12 [00:27<00:08,  2.93s/it] 83%|████████▎ | 10/12 [00:30<00:05,  2.94s/it] 92%|█████████▏| 11/12 [00:33<00:02,  2.89s/it]100%|██████████| 12/12 [00:36<00:00,  3.00s/it]100%|██████████| 12/12 [00:36<00:00,  3.04s/it]
Time per token (Autoregressive Sampling): 20.41 tok/s
Benchmarking Speculative Sampling...
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:03<00:37,  3.39s/it] 17%|█▋        | 2/12 [00:05<00:23,  2.36s/it] 25%|██▌       | 3/12 [00:08<00:24,  2.71s/it] 33%|███▎      | 4/12 [00:10<00:19,  2.44s/it] 42%|████▏     | 5/12 [00:12<00:16,  2.41s/it] 50%|█████     | 6/12 [00:14<00:14,  2.36s/it] 58%|█████▊    | 7/12 [00:16<00:11,  2.29s/it] 67%|██████▋   | 8/12 [00:18<00:08,  2.19s/it] 75%|███████▌  | 9/12 [00:21<00:07,  2.38s/it] 83%|████████▎ | 10/12 [00:23<00:04,  2.19s/it] 92%|█████████▏| 11/12 [00:25<00:02,  2.17s/it]100%|██████████| 12/12 [00:28<00:00,  2.40s/it]100%|██████████| 12/12 [00:28<00:00,  2.38s/it]
Time per token (Speculative Sampling): 27.15 tok/s
